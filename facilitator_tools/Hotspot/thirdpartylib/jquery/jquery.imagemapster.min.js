!function(a){a(function(){function e(){}function f(b){var c=new e;return c.then=function(a){var c;try{return a&&(c=a(b)),l(c===d?b:c)}catch(e){return g(e)}},a(c)}function g(b){var c=new e;return c.then=function(a,c){var e;try{return c?(e=c(b),l(e===d?b:e)):g(b)}catch(f){return g(f)}},a(c)}function h(a){return k(a,function(a){return g(a)})}function i(){function n(a,b,c){return k(a,b,c)}function o(a){m(f(a))}function p(a){m(g(a))}function q(a){l(a)}var b,c,h,j,k,l,m;return h=[],j=[],k=function(a,b,c){var d=i();return h.push(function(c){c.then(a,b).then(d.resolve,d.reject,d.progress)}),c&&j.push(c),d.promise},l=function(a){for(var b,c=0;b=j[c++];)b(a)},m=function(a){var b,c=0;for(k=a.then,m=l=function(){throw new Error("already completed")},j=d;b=h[c++];)b(a);h=[]},b={},c=new e,c.then=b.then=n,b.promise=a(c),b.resolver=a({resolve:b.resolve=o,reject:b.reject=p,progress:b.progress=q}),b}function j(a){return a&&"function"==typeof a.then}function k(a,b,c,d){var e=l(a);return e.then(b,c,d)}function l(a){var b,c;return a instanceof e?b=a:(c=i(),j(a)?(a.then(c.resolve,c.reject,c.progress),b=c.promise):(c.resolve(a),b=c.promise)),b}function m(a,b,c,d,e){return v(2,arguments),k(a,function(a){function q(a){l(a)}function r(a){m(a)}function s(a){n(a)}function t(){l=m=n=w}var f,g,h,j,l,m,n,o,p;if(o=a.length>>>0,f=Math.max(0,Math.min(b,o)),g=[],j=i(),h=k(j,c,d,e),f)for(l=function(a){g.push(a),--f||(t(),j.resolve(g))},m=function(a){t(),j.reject(a)},n=j.progress,p=0;o>p;++p)p in a&&k(a[p],q,r,s);else j.resolve(g);return h})}function n(a,b,c,d){return v(1,arguments),k(a,function(a){return t(a,o,[])}).then(b,c,d)}function o(a,b,c){return a[c]=b,a}function p(a,b,c,d){function e(a){return b?b(a[0]):a[0]}return m(a,1,e,c,d)}function q(a,b){return k(a,function(a){return r(a,b)})}function r(a,b){var c,d,e;for(d=a.length>>>0,c=new Array(d),e=0;d>e;e++)e in a&&(c[e]=k(a[e],b));return t(c,o,c)}function s(a,b,e){var f=c.call(arguments,1);return k(a,function(a){return t.apply(d,[a].concat(f))})}function t(a,c,d){var e,f;return e=a.length,f=[function(a,b,d){return k(a,function(a){return k(b,function(b){return c(a,b,d,e)})})}],arguments.length>2&&f.push(d),b.apply(a,f)}function u(a,b,c){var d=arguments.length>2;return k(a,function(a){return d&&(a=c),b.resolve(a),a},function(a){return b.reject(a),g(a)},b.progress)}function v(a,b){for(var c,d=b.length;d>a;)if(c=b[--d],null!=c&&"function"!=typeof c)throw new Error("callback is not a function")}function w(){}var a,b,c,d;return k.defer=i,k.reject=h,k.isPromise=j,k.all=n,k.some=m,k.any=p,k.map=q,k.reduce=s,k.chain=u,a=Object.freeze||function(a){return a},e.prototype=a({always:function(a,b){return this.then(a,a,b)},otherwise:function(a){return this.then(d,a)}}),c=[].slice,b=[].reduce||function(a){var b,c,d,e,f;if(f=0,b=Object(this),e=b.length>>>0,c=arguments,c.length<=1)for(;;){if(f in b){d=b[f++];break}if(++f>=e)throw new TypeError}else d=c[1];for(;e>f;++f)f in b&&(d=a(d,b[f],f,b));return d},k})}("function"==typeof define?define:function(a){"undefined"!=typeof module?module.exports=a():jQuery.mapster_when=a()}),function($){$.fn.mapster=function(a){var b=$.mapster.impl;return $.isFunction(b[a])?b[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void $.error("Method "+a+" does not exist on jQuery.mapster"):b.bind.apply(this,arguments)},$.mapster={version:"1.2.8",render_defaults:{isSelectable:!0,isDeselectable:!0,fade:!1,fadeDuration:150,fill:!0,fillColor:"FF0000",fillColorMask:"FFFFFF",fillOpacity:.7,highlight:!0,stroke:!1,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,includeKeys:"",altImage:null,altImageId:null,altImages:{}},defaults:{clickNavigate:!1,wrapClass:null,wrapCss:null,onGetList:null,sortList:!1,listenToList:!1,mapKey:"",mapValue:"",singleSelect:!1,listKey:"value",listSelectedAttribute:"selected",listSelectedClass:null,onClick:null,onMouseover:null,onMouseout:null,mouseoutDelay:0,onStateChange:null,boundList:null,onConfigured:null,configTimeout:3e4,noHrefIsMask:!0,scaleMap:!0,safeLoad:!1,areas:[]},shared_defaults:{render_highlight:{fade:!0},render_select:{fade:!1},staticState:null,selected:null},area_defaults:{includeKeys:"",isMask:!1},canvas_style:{position:"absolute",left:0,top:0,padding:0,border:0},hasCanvas:null,isTouch:null,windowLoaded:!1,map_cache:[],hooks:{},addHook:function(a,b){this.hooks[a]=(this.hooks[a]||[]).push(b)},callHooks:function(a,b){$.each(this.hooks[a]||[],function(a,c){c.apply(b)})},utils:{when:$.mapster_when,defer:$.mapster_when.defer,subclass:function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments,0);c.base=a.prototype,c.base.init=function(){a.prototype.constructor.apply(c,d)},b.apply(c,d)};return c.prototype=new a,c.prototype.constructor=c,c},asArray:function(a){return a.constructor===Array?a:this.split(a)},split:function(a,b){var c,d,e=a.split(",");for(c=0;c<e.length;c++)d=$.trim(e[c]),""===d?e.splice(c,1):e[c]=b?b(d):d;return e},updateProps:function(a,b){var c,d=a||{},e=$.isEmptyObject(d)?b:a;return c=[],$.each(e,function(a){c.push(a)}),$.each(Array.prototype.slice.call(arguments,1),function(a,b){$.each(b||{},function(a){if(!c||$.inArray(a,c)>=0){var e=b[a];$.isPlainObject(e)?d[a]=$.extend(d[a]||{},e):e&&e.constructor===Array?d[a]=e.slice(0):"undefined"!=typeof e&&(d[a]=b[a])}})}),d},isElement:function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&1===a.nodeType&&"string"==typeof a.nodeName},indexOfProp:function(a,b,c){var d=a.constructor===Array?-1:null;return $.each(a,function(a,e){return e&&(b?e[b]:e)===c?(d=a,!1):void 0}),d},boolOrDefault:function(a,b){return this.isBool(a)?a:b||!1},isBool:function(a){return"boolean"==typeof a},isUndef:function(a){return"undefined"==typeof a},ifFunction:function(a,b,c){$.isFunction(a)&&a.call(b,c)},size:function(a,b){var c=$.mapster.utils;return{width:b?a.width||a.naturalWidth:c.imgWidth(a,!0),height:b?a.height||a.naturalHeight:c.imgHeight(a,!0),complete:function(){return!!this.height&&!!this.width}}},setOpacity:function(a,b){a.style.opacity=b},fader:function(){var a={},b=0,c=function(d,e,f,g){var h,j,i=g/15,k=$.mapster.utils;if("number"==typeof d){if(j=a[d],!j)return}else h=k.indexOfProp(a,null,d),h&&delete a[h],a[++b]=j=d,d=b;f=f||1,e=e+f/i>f-.01?f:e+f/i,k.setOpacity(j,e),f>e&&setTimeout(function(){c(d,e,f,g)},15)};return c}()},getBoundList:function(a,b){if(!a.boundList)return null;var c,d,e=$(),f=$.mapster.utils.split(b);return a.boundList.each(function(b,g){for(c=0;c<f.length;c++)d=f[c],$(g).is("["+a.listKey+'="'+d+'"]')&&(e=e.add(g))}),e},setBoundListProperties:function(a,b,c){b.each(function(b,d){a.listSelectedClass&&(c?$(d).addClass(a.listSelectedClass):$(d).removeClass(a.listSelectedClass)),a.listSelectedAttribute&&$(d).attr(a.listSelectedAttribute,c)})},getMapDataIndex:function(a){var b,c;switch(a.tagName&&a.tagName.toLowerCase()){case"area":c=$(a).parent().attr("name"),b=$("img[usemap='#"+c+"']")[0];break;case"img":b=a}return b?this.utils.indexOfProp(this.map_cache,"image",b):-1},getMapData:function(a){var b=this.getMapDataIndex(a.length?a[0]:a);return b>=0?b>=0?this.map_cache[b]:null:void 0},queueCommand:function(a,b,c,d){return a&&(!a.complete||a.currentAction)?(a.commands.push({that:b,command:c,args:d}),!0):!1},unload:function(){this.impl.unload(),this.utils=null,this.impl=null,$.fn.mapster=null,$.mapster=null,$("*").unbind()}};var m=$.mapster,u=m.utils,ap=Array.prototype;$.each(["width","height"],function(a,b){var c=b.substr(0,1).toUpperCase()+b.substr(1);u["img"+c]=function(a,d){return(d?$(a)[b]():0)||a[b]||a["natural"+c]||a["client"+c]||a["offset"+c]}}),m.Method=function(a,b,c,d){var e=this;e.name=d.name,e.output=a,e.input=a,e.first=d.first||!1,e.args=d.args?ap.slice.call(d.args,0):[],e.key=d.key,e.func_map=b,e.func_area=c,e.name=d.name,e.allowAsync=d.allowAsync||!1},m.Method.prototype.go=function(){var a,b,c,d,e,f=this.input,g=[],h=this;for(d=f.length,a=0;d>a;a++)if(b=$.mapster.getMapData(f[a])){if(!h.allowAsync&&m.queueCommand(b,h.input,h.name,h.args)){this.first&&(e="");continue}if(c=b.getData("AREA"===f[a].nodeName?f[a]:this.key),c?$.inArray(c,g)<0&&g.push(c):e=this.func_map.apply(b,h.args),this.first||"undefined"!=typeof e)break}return $(g).each(function(a,b){e=h.func_area.apply(b,h.args)}),"undefined"!=typeof e?e:this.output},$.mapster.impl=function(){function merge_areas(a,b){var c,d,e=a.options.areas;b&&$.each(b,function(b,f){f&&f.key&&(d=u.indexOfProp(e,"key",f.key),d>=0?$.extend(e[d],f):e.push(f),c=a.getDataForKey(f.key),c&&$.extend(c.options,f))})}function merge_options(a,b){var c=u.updateProps({},b);delete c.areas,u.updateProps(a.options,c),merge_areas(a,b.areas),u.updateProps(a.area_options,a.options)}var me={},removeMap,addMap;return addMap=function(a){return m.map_cache.push(a)-1},removeMap=function(a){m.map_cache.splice(a.index,1);for(var b=m.map_cache.length-1;b>=this.index;b--)m.map_cache[b].index--},me.get=function(a){var b=m.getMapData(this);if(!b||!b.complete)throw"Can't access data until binding complete.";return new m.Method(this,function(){return this.getSelected()},function(){return this.isSelected()},{name:"get",args:arguments,key:a,first:!0,allowAsync:!0,defaultReturn:""}).go()},me.data=function(a){return new m.Method(this,null,function(){return this},{name:"data",args:arguments,key:a}).go()},me.highlight=function(a){return new m.Method(this,function(){if(a!==!1){var b=this.highlightId;return b>=0?this.data[b].key:null}this.ensureNoHighlight()},function(){this.highlight()},{name:"highlight",args:arguments,key:a,first:!0}).go()},me.keys=function(a,b){function e(a){var d,e=[];b?(d=a.areas(),$.each(d,function(a,b){e=e.concat(b.keys)})):e.push(a.key),$.each(e,function(a,b){$.inArray(b,c)<0&&c.push(b)})}var c=[],d=m.getMapData(this);if(!d||!d.complete)throw"Can't access data until binding complete.";return d&&d.complete?("string"==typeof a?b?e(d.getDataForKey(a)):c=[d.getKeysForGroup(a)]:(b=a,this.each(function(a,b){"AREA"===b.nodeName&&e(d.getDataForArea(b))})),c.join(",")):""},me.select=function(){me.set.call(this,!0)},me.deselect=function(){me.set.call(this,!1)},me.set=function(a,b,c){function i(b){if(b)switch(a){case!0:b.select(f);break;case!1:b.deselect(!0);break;default:b.toggle(f)}}function j(a){a&&$.inArray(a,h)<0&&(h.push(a),g+=(""===g?"":",")+a.key)}function k(b){$.each(h,function(a,b){i(b)}),a||b.removeSelectionFinish(),b.options.boundList&&m.setBoundListProperties(b.options,m.getBoundList(b.options,g),a)}var d,e,g,h,f=c;return this.filter("img,area").each(function(c,i){var l;e=m.getMapData(i),e!==d&&(d&&k(d),h=[],g=""),e&&(l="","IMG"===i.nodeName.toUpperCase()?m.queueCommand(e,$(i),"set",[a,b,f])||(b instanceof Array?b.length&&(l=b.join(",")):l=b,l&&$.each(u.split(l),function(a,b){j(e.getDataForKey(b.toString())),d=e})):(f=b,m.queueCommand(e,$(i),"set",[a,f])||(j(e.getDataForArea(i)),d=e)))}),e&&k(e),this},me.unbind=function(a){return new m.Method(this,function(){this.clearEvents(),this.clearMapData(a),removeMap(this)},null,{name:"unbind",args:arguments}).go()},me.rebind=function(a){return new m.Method(this,function(){var b=this;b.complete=!1,b.configureOptions(a),b.bindImages().then(function(){b.buildDataset(!0),b.complete=!0})},null,{name:"rebind",args:arguments}).go()},me.get_options=function(a,b){var c=u.isBool(a)?a:b;return new m.Method(this,function(){var a=$.extend({},this.options);return c&&(a.render_select=u.updateProps({},m.render_defaults,a,a.render_select),a.render_highlight=u.updateProps({},m.render_defaults,a,a.render_highlight)),a},function(){return c?this.effectiveOptions():this.options},{name:"get_options",args:arguments,first:!0,allowAsync:!0,key:a}).go()},me.set_options=function(a){return new m.Method(this,function(){merge_options(this,a)},null,{name:"set_options",args:arguments}).go()},me.unload=function(){var a;for(a=m.map_cache.length-1;a>=0;a--)m.map_cache[a]&&me.unbind.call($(m.map_cache[a].image));me.graphics=null},me.snapshot=function(){return new m.Method(this,function(){$.each(this.data,function(a,b){b.selected=!1}),this.base_canvas=this.graphics.createVisibleCanvas(this),$(this.image).before(this.base_canvas)},null,{name:"snapshot"}).go()},me.state=function(){var a,b=null;return $(this).each(function(c,d){return"IMG"===d.nodeName?(a=m.getMapData(d),a&&(b=a.state()),!1):void 0}),b},me.bind=function(a){return this.each(function(b,c){var d,e,f,g;if(d=$(c),g=m.getMapData(c)){if(me.unbind.apply(d),!g.complete)return d.bind(),!0;g=null}return f=this.getAttribute("usemap"),e=f&&$('map[name="'+f.substr(1)+'"]'),d.is("img")&&f&&e.size()>0?(d.css("border",0),void(g||(g=new m.MapData(this,a),g.index=addMap(g),g.map=e,g.bindImages().then(function(){g.initialize()})))):!0})},me.init=function(a){var b,c;return m.hasCanvas=document.namespaces&&document.namespaces.g_vml_?!1:$("<canvas></canvas>")[0].getContext?!0:!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?m.isTouch="ontouchstart"in document.documentElement:m.isTouch=!1,m.hasCanvas||document.namespaces?($.extend(m.defaults,m.render_defaults,m.shared_defaults),$.extend(m.area_defaults,m.render_defaults,m.shared_defaults),u.isBool(a)&&(m.hasCanvas=a),void(!$.browser.msie||m.hasCanvas||document.namespaces.v||(document.namespaces.add("v","urn:schemas-microsoft-com:vml"),b=document.createStyleSheet(),c=["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"],$.each(c,function(a,c){b.addRule("v\\:"+c,"behavior: url(#default#VML); antialias:true")})))):void($.fn.mapster=function(){return this})},me.test=function(obj){return eval(obj)},me}(),$.mapster.impl.init()}(jQuery),function(a){function e(b,c,d){var e=b,f=e.map_data,g=d.isMask;a.each(c.areas(),function(a,b){d.isMask=g||b.nohref&&f.options.noHrefIsMask,e.addShape(b,d)}),d.isMask=g}var b,c=a.mapster,d=c.utils;c.Graphics=function(a){var b=this;b.active=!1,b.canvas=null,b.width=0,b.height=0,b.shapes=[],b.masks=[],b.map_data=a},b=c.Graphics.prototype={constructor:c.Graphics,begin:function(b,c){var d=a(b);this.elementName=c,this.canvas=b,this.width=d.width(),this.height=d.height(),this.shapes=[],this.masks=[],this.active=!0},addShape:function(a,b){var c=b.isMask?this.masks:this.shapes;c.push({mapArea:a,options:b})},createVisibleCanvas:function(b){return a(this.createCanvasFor(b)).addClass("mapster_el").css(c.canvas_style)[0]},addShapeGroup:function(b,f,g){var i,j,k,h=this,l=this.map_data,m=b.effectiveRenderOptions(f);g&&a.extend(m,g),"select"===f?(j="static_"+b.areaId.toString(),k=l.base_canvas):k=l.overlay_canvas,h.begin(k,j),m.includeKeys&&(i=d.split(m.includeKeys),a.each(i,function(a,b){var c=l.getDataForKey(b.toString());e(h,c,c.effectiveRenderOptions(f))})),e(h,b,m),h.render(),m.fade&&d.fader(c.hasCanvas?k:a(k).find("._fill").not(".mapster_mask"),0,c.hasCanvas?1:m.fillOpacity,m.fadeDuration)}},c.hasCanvas?(b.hex_to_decimal=function(a){return Math.max(0,Math.min(parseInt(a,16),255))},b.css3color=function(a,b){return"rgba("+this.hex_to_decimal(a.substr(0,2))+","+this.hex_to_decimal(a.substr(2,2))+","+this.hex_to_decimal(a.substr(4,2))+","+b+")"},b.renderShape=function(a,b,c){var d,e=b.coords(null,c);switch(b.shape){case"rect":a.rect(e[0],e[1],e[2]-e[0],e[3]-e[1]);break;case"poly":for(a.moveTo(e[0],e[1]),d=2;d<b.length;d+=2)a.lineTo(e[d],e[d+1]);a.lineTo(e[0],e[1]);break;case"circ":case"circle":a.arc(e[0],e[1],e[2],0,2*Math.PI,!1)}},b.addAltImage=function(a,b,c,d){a.beginPath(),this.renderShape(a,c),a.closePath(),a.clip(),a.globalAlpha=d.altImageOpacity||d.fillOpacity,a.drawImage(b,0,0,c.owner.scaleInfo.width,c.owner.scaleInfo.height)},b.render=function(){var b,c,d=this,e=d.map_data,f=d.masks.length,g=d.createCanvasFor(e),h=g.getContext("2d"),i=d.canvas.getContext("2d");return f&&(b=d.createCanvasFor(e),c=b.getContext("2d"),c.clearRect(0,0,b.width,b.height),a.each(d.masks,function(a,b){c.save(),c.beginPath(),d.renderShape(c,b.mapArea),c.closePath(),c.clip(),c.lineWidth=0,c.fillStyle="#000",c.fill(),c.restore()})),a.each(d.shapes,function(a,b){h.save(),b.options.fill&&(b.options.altImageId?d.addAltImage(h,e.images[b.options.altImageId],b.mapArea,b.options):(h.beginPath(),d.renderShape(h,b.mapArea),h.closePath(),h.fillStyle=d.css3color(b.options.fillColor,b.options.fillOpacity),h.fill())),h.restore()}),a.each(d.shapes.concat(d.masks),function(a,b){var c=1===b.options.strokeWidth?.5:0;b.options.stroke&&(h.save(),h.strokeStyle=d.css3color(b.options.strokeColor,b.options.strokeOpacity),h.lineWidth=b.options.strokeWidth,h.beginPath(),d.renderShape(h,b.mapArea,c),h.closePath(),h.stroke(),h.restore())}),f?(c.globalCompositeOperation="source-out",c.drawImage(g,0,0),i.drawImage(b,0,0)):i.drawImage(g,0,0),d.active=!1,d.canvas},b.createCanvasFor=function(b){return a('<canvas width="'+b.scaleInfo.width+'" height="'+b.scaleInfo.height+'"></canvas>')[0]},b.clearHighlight=function(){var a=this.map_data.overlay_canvas;a.getContext("2d").clearRect(0,0,a.width,a.height)},b.removeSelections=function(){},b.refreshSelections=function(){var b,c=this.map_data;b=c.base_canvas,c.base_canvas=this.createVisibleCanvas(c),a(c.base_canvas).hide(),a(b).before(c.base_canvas),c.redrawSelections(),a(c.base_canvas).show(),a(b).remove()}):(d.setOpacity=function(b,c){a(b).each(function(b,d){"undefined"!=typeof d.opacity?d.opacity=c:a(d).css("opacity",c)})},b.renderShape=function(b,c,d){var f,g,h,i,j,k,l,e=this,m=b.coords();switch(j=e.elementName?'name="'+e.elementName+'" ':"",k=d?'class="'+d+'" ':"",i='<v:fill color="#'+c.fillColor+'" class="_fill" opacity="'+(c.fill?c.fillOpacity:0)+'" /><v:stroke class="_fill" opacity="'+c.strokeOpacity+'"/>',g=c.stroke?" strokeweight="+c.strokeWidth+' stroked="t" strokecolor="#'+c.strokeColor+'"':' stroked="f"',f=c.fill?' filled="t"':' filled="f"',b.shape){case"rect":l="<v:rect "+k+j+f+g+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+m[0]+"px;top:"+m[1]+"px;width:"+(m[2]-m[0])+"px;height:"+(m[3]-m[1])+'px;">'+i+"</v:rect>";break;case"poly":l="<v:shape "+k+j+f+g+' coordorigin="0,0" coordsize="'+e.width+","+e.height+'" path="m '+m[0]+","+m[1]+" l "+m.slice(2).join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+e.width+"px;height:"+e.height+'px;">'+i+"</v:shape>";break;case"circ":case"circle":l="<v:oval "+k+j+f+g+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(m[0]-m[2])+"px;top:"+(m[1]-m[2])+"px;width:"+2*m[2]+"px;height:"+2*m[2]+'px;">'+i+"</v:oval>"}return h=a(l),a(e.canvas).append(h),h},b.render=function(){var b,c=this;return a.each(this.shapes,function(a,b){c.renderShape(b.mapArea,b.options)}),this.masks.length&&a.each(this.masks,function(a,e){b=d.updateProps({},e.options,{fillOpacity:1,fillColor:e.options.fillColorMask}),c.renderShape(e.mapArea,b,"mapster_mask")}),this.active=!1,this.canvas},b.createCanvasFor=function(b){var c=b.scaleInfo.width,d=b.scaleInfo.height;return a('<var width="'+c+'" height="'+d+'" style="zoom:1;overflow:hidden;display:block;width:'+c+"px;height:"+d+'px;"></var>')[0]},b.clearHighlight=function(){a(this.map_data.overlay_canvas).children().remove()},b.removeSelections=function(b){b>=0?a(this.map_data.base_canvas).find('[name="static_'+b.toString()+'"]').remove():a(this.map_data.base_canvas).children().remove()},b.refreshSelections=function(){return null})}(jQuery),function(a){var b=a.mapster,c=b.utils,d=[];b.MapImages=function(a){this.owner=a,this.clear()},b.MapImages.prototype={constructor:b.MapImages,slice:function(){return d.slice.apply(this,arguments)},splice:function(){d.slice.apply(this.status,arguments);var a=d.slice.apply(this,arguments);return a},complete:function(){return a.inArray(!1,this.status)<0},_add:function(a){var b=d.push.call(this,a)-1;return this.status[b]=!1,b},indexOf:function(b){return a.inArray(b,this)},clear:function(){var b=this;b.ids&&b.ids.length>0&&a.each(b.ids,function(a,c){delete b[c]}),b.ids=[],b.length=0,b.status=[],b.splice(0)},add:function(b,c){var d,e,f=this;if(b){if("string"==typeof b){if(e=b,b=f[e],"object"==typeof b)return f.indexOf(b);b=a("<img />").addClass("mapster_el").hide(),d=f._add(b[0]),b.bind("load",function(a){f.imageLoaded.call(f,a)}).bind("error",function(a){f.imageLoadError.call(f,a)}),b.attr("src",e)}else d=f._add(a(b)[0]);if(c){if(this[c])throw c+" is already used or is not available as an altImage alias.";f.ids.push(c),f[c]=f[d]}return d}},bind:function(a){var d,b=this,e=b.owner.options.configTimeout/200,f=function(){var a;for(a=b.length;a-->0&&b.isLoaded(a););b.complete()?b.resolve():e-->0?b.imgTimeout=window.setTimeout(function(){f.call(b,!0)},50):b.imageLoadError.call(b)};return d=b.deferred=c.defer(),f(),d},resolve:function(){var a=this,b=a.deferred;b&&(a.deferred=null,b.resolve())},imageLoaded:function(b){var c=this,d=c.indexOf(b.target);d>=0&&(c.status[d]=!0,a.inArray(!1,c.status)<0&&c.resolve())},imageLoadError:function(a){clearTimeout(this.imgTimeout),this.triesLeft=0;var b=a?"The image "+a.target.src+" failed to load.":"The images never seemed to finish loading. You may just need to increase the configTimeout if images could take a long time to load.";throw b},isLoaded:function(a){var b,d=this,e=d.status;return e[a]?!0:(b=d[a],"undefined"!=typeof b.complete?e[a]=b.complete:e[a]=!!c.imgWidth(b),e[a])}}}(jQuery),function(a){function d(b){a.extend(b,{complete:!1,map:null,base_canvas:null,overlay_canvas:null,commands:[],data:[],mapAreas:[],_xref:{},highlightId:-1,currentAreaId:-1,_tooltip_events:[],scaleInfo:null,index:-1,activeAreaEvent:null})}function e(a){return[a,a.render_highlight,a.render_select]}function f(d){var f=d.options,g=d.images;a.mapster.hasCanvas&&(a.each(f.altImages||{},function(a,b){g.add(b,a)}),a.each([f].concat(f.areas),function(b,c){a.each(e(c),function(a,b){b&&b.altImage&&(b.altImageId=g.add(b.altImage))})})),d.area_options=c.updateProps({},b.area_defaults,f)}function g(a,b,d,e){function f(b){a.currentAreaId!==b&&a.highlightId>=0&&e.resolve()}return e=e||c.when.defer(),a.activeAreaEvent&&(window.clearTimeout(a.activeAreaEvent),a.activeAreaEvent=0),0>b?void 0:(d.owner.currentAction||b?a.activeAreaEvent=window.setTimeout(function(){return function(){g(a,0,d,e)}}(d),b||100):f(d.areaId),e)}function h(b){a.mapster.hasCanvas||this.blur(),b.preventDefault()}function i(b,c){if(a(c.target).hasClass("highlightable")){var d=b.getAllDataForArea(this),e=d.length?d[0]:null;if(!e||e.isNotRendered()||e.owner.currentAction)return;if(b.currentAreaId===e.areaId)return;b.highlightId!==e.areaId&&(b.clearEffects(),e.highlight(),b.options.showToolTip&&a.each(d,function(a,b){b.effectiveOptions().toolTip&&b.showToolTip()})),b.currentAreaId=e.areaId,a.isFunction(b.options.onMouseover)&&b.options.onMouseover.call(this,{e:c,options:e.effectiveOptions(),key:e.key,selected:e.isSelected()})}}function j(b,c){var d,e=b.getDataForArea(this),f=b.options;b.currentAreaId<0||!e||(d=b.getDataForArea(c.relatedTarget),d!==e&&(b.currentAreaId=-1,e.area=null,g(b,f.mouseoutDelay,e).then(b.clearEffects),a.isFunction(f.onMouseout)&&f.onMouseout.call(this,{e:c,options:f,key:e.key,selected:e.isSelected()})))}function k(b){var c=b.options;b.ensureNoHighlight(),c.toolTipClose&&a.inArray("area-mouseout",c.toolTipClose)>=0&&b.activeToolTip&&b.clearToolTip()}function l(d,e){function p(h){var n,q;if(k=h.isSelectable()&&(h.isDeselectable()||!h.isSelected()),j=k?!h.isSelected():h.isSelected(),i=b.getBoundList(o,h.key),a.isFunction(o.onClick)&&(l=o.onClick.call(m,{e:e,listTarget:i,key:h.key,selected:j}),c.isBool(l))){if(!l)return!1;if(q=a(h.area).attr("href"),"#"!==q)return window.location.href=q,!1}k&&(f=h.toggle()),o.boundList&&o.boundList.length>0&&b.setBoundListProperties(o,i,h.isSelected()),n=h.effectiveOptions(),n.includeKeys&&(g=c.split(n.includeKeys),a.each(g,function(a,b){var c=d.getDataForKey(b.toString());c.options.isMask||p(c)}))}var f,g,i,j,k,l,m=this,n=d.getDataForArea(this),o=d.options;return h.call(this,e),o.clickNavigate&&n.href?void(window.location.href=n.href):void(n&&!n.owner.currentAction&&(o=d.options,p(n)))}var b=a.mapster,c=b.utils;b.MapData=function(a,c){var e=this;e.image=a,e.images=new b.MapImages(e),e.graphics=new b.Graphics(e),e.imgCssText=a.style.cssText||null,d(e),e.configureOptions(c),e.mouseover=function(a){i.call(this,e,a)},e.mouseout=function(a){j.call(this,e,a)},e.click=function(a){l.call(this,e,a)},e.clearEffects=function(a){k.call(this,e,a)}},b.MapData.prototype={constructor:b.MapData,configureOptions:function(a){this.options=c.updateProps({},b.defaults,a)},bindImages:function(){var a=this,b=a.images;return b.length>2?b.splice(2):0===b.length&&(b.add(a.image),b.add(a.image.src)),f(a),a.images.bind()},isActive:function(){return!this.complete||this.currentAction},state:function(){return{complete:this.complete,resizing:"resizing"===this.currentAction,zoomed:this.zoomed,zoomedArea:this.zoomedArea,scaleInfo:this.scaleInfo}},wrapId:function(){return"mapster_wrap_"+this.index},_idFromKey:function(a){return"string"==typeof a&&this._xref.hasOwnProperty(a)?this._xref[a]:-1},getSelected:function(){var b="";return a.each(this.data,function(a,c){c.isSelected()&&(b+=(b?",":"")+this.key)}),b},getAllDataForArea:function(b,d){var e,f,g,h=this,i=a(b).filter("area").attr(h.options.mapKey);if(i)for(g=[],i=c.split(i),e=0;e<(d||i.length);e++)f=h.data[h._idFromKey(i[e])],f.area=b.length?b[0]:b,g.push(f);return g},getDataForArea:function(a){var b=this.getAllDataForArea(a,1);return b?b[0]||null:null},getDataForKey:function(a){return this.data[this._idFromKey(a)]},getKeysForGroup:function(a){var b=this.getDataForKey(a);return b?b.isPrimary?b.key:this.getPrimaryKeysForMapAreas(b.areas()).join(","):""},getPrimaryKeysForMapAreas:function(b){var c=[];return a.each(b,function(b,d){a.inArray(d.keys[0],c)<0&&c.push(d.keys[0])}),c},getData:function(a){return"string"==typeof a?this.getDataForKey(a):a&&a.mapster||c.isElement(a)?this.getDataForArea(a):null},ensureNoHighlight:function(){var a;this.highlightId>=0&&(this.graphics.clearHighlight(),a=this.data[this.highlightId],a.changeState("highlight",!1),this.setHighlightId(-1))},setHighlightId:function(a){this.highlightId=a},clearSelections:function(){a.each(this.data,function(a,b){b.selected&&b.deselect(!0)}),this.removeSelectionFinish()},setAreaOptions:function(a){var b,d,e;for(a=a||[],b=a.length-1;b>=0;b--)d=a[b],d&&(e=this.getDataForKey(d.key),e&&(c.updateProps(e.options,d),c.isBool(d.selected)&&(e.selected=d.selected)))},drawSelections:function(a){var b,d=c.asArray(a);for(b=d.length-1;b>=0;b--)this.data[d[b]].drawSelection()},redrawSelections:function(){a.each(this.data,function(a,b){b.isSelectedOrStatic()&&b.drawSelection()})},initialize:function(){var d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.options;if(!p.complete){for(l=a(p.image),h=l.parent().attr("id"),h&&h.length>=12&&"mapster_wrap"===h.substring(0,12)?(g=l.parent(),g.attr("id",p.wrapId()),g.attr("class","wrapper")):(g=a('<div id="'+p.wrapId()+'" class="wrapper"></div>'),q.wrapClass&&(q.wrapClass===!0?g.addClass(l[0].className):g.addClass(q.wrapClass))),p.wrapper=g,p.scaleInfo=o=c.scaleMap(p.images[0],p.images[1],q.scaleMap),p.base_canvas=e=p.graphics.createVisibleCanvas(p),p.overlay_canvas=f=p.graphics.createVisibleCanvas(p),d=a(p.images[1]).addClass("mapster_el "+p.images[0].className).attr({id:null,usemap:null}),k=c.size(p.images[0]),k.complete&&d.css({width:k.width,height:k.height}),p.buildDataset(),i={display:"block",position:"relative",padding:0,width:o.width,height:o.height},q.wrapCss&&a.extend(i,q.wrapCss),l.parent()[0]!==p.wrapper[0]&&l.before(p.wrapper),g.css(i),a(p.images.slice(2)).hide(),j=1;j<p.images.length;j++)g.append(p.images[j]);g.append(e).append(f).append(l.css(b.canvas_style)),c.setOpacity(p.images[0],0),a(p.images[1]).show(),c.setOpacity(p.images[1],1),q.isSelectable&&q.onGetList&&(n=p.data.slice(0),q.sortList&&(m="desc"===q.sortList?function(a,b){return a===b?0:a>b?-1:1}:function(a,b){return a===b?0:b>a?-1:1},n.sort(function(a,b){return a=a.value,b=b.value,m(a,b)})),p.options.boundList=q.onGetList.call(p.image,n)),p.complete=!0,p.processCommandQueue(),q.onConfigured&&"function"==typeof q.onConfigured&&q.onConfigured.call(l,!0)}},buildDataset:function(c){function u(a,c){var d=new b.AreaData(r,a,c);return d.areaId=r._xref[a]=r.data.push(d)-1,d.areaId}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,t,r=this,s=r.options;for(r._xref={},r.data=[],c||(r.mapAreas=[]),t=!s.mapKey,t&&(s.mapKey="data-mapster-key"),d=a.browser.msie&&a.browser.version<=7?"area":t?"area[coords]":"area["+s.mapKey+"]",e=a(r.map).find(d).unbind(".mapster"),n=0;n<e.length;n++)if(g=0,i=e[n],h=a(i),i.coords){for(t?(j=String(n),h.attr("data-mapster-key",j)):j=i.getAttribute(s.mapKey),c?(k=r.mapAreas[h.data("mapster")-1],k.configure(j)):(k=new b.MapArea(r,i,j),r.mapAreas.push(k)),m=k.keys,f=m.length-1;f>=0;f--)l=m[f],s.mapValue&&(o=h.attr(s.mapValue)),t?(g=u(r.data.length,o),p=r.data[g],p.key=l=g.toString()):(g=r._xref[l],g>=0?(p=r.data[g],o&&!r.data[g].value&&(p.value=o)):(g=u(l,o),p=r.data[g],p.isPrimary=0===f)),k.areaDataXref.push(g),p.areasXref.push(n);q=h.attr("href"),q&&"#"!==q&&!p.href&&(p.href=q),k.nohref||(h.bind("click.mapster",r.click),b.isTouch||h.bind("mouseover.mapster",r.mouseover).bind("mouseout.mapster",r.mouseout).bind("mousedown.mapster",r.mousedown)),h.data("mapster",n+1)}r.setAreaOptions(s.areas),r.redrawSelections()},processCommandQueue:function(){for(var a,c=this;!c.currentAction&&c.commands.length;)a=c.commands[0],c.commands.splice(0,1),b.impl[a.command].apply(a.that,a.args)},clearEvents:function(){a(this.map).find("area").unbind(".mapster"),a(this.images).unbind(".mapster")},_clearCanvases:function(b){b||a(this.base_canvas).remove(),a(this.overlay_canvas).remove()},clearMapData:function(b){var d=this;this._clearCanvases(b),a.each(this.data,function(a,b){b.reset()}),this.data=null,b||(this.image.style.cssText=this.imgCssText,a(this.wrapper).before(this.image).remove()),d.images.clear(),this.image=null,c.ifFunction(this.clearTooltip,this)},removeSelectionFinish:function(){var a=this.graphics;a.refreshSelections(),a.clearHighlight()}}}(jQuery),function(a){function d(b){var c=this,d=c.owner;d.options.singleSelect&&d.clearSelections(),c.isSelected()||(b&&(c.optsCache=a.extend(c.effectiveRenderOptions("select"),b,{altImageId:d.images.add(b.altImage)})),c.drawSelection(),c.selected=!0,c.changeState("select",!0)),d.options.singleSelect&&d.graphics.refreshSelections()}function e(a){var b=this;b.selected=!1,b.changeState("select",!1),b.optsCache=null,b.owner.graphics.removeSelections(b.areaId),a||b.owner.removeSelectionFinish()}function f(a){var b=this;return b.isSelected()?b.deselect():b.select(a),b.isSelected()}var b=a.mapster,c=b.utils;b.AreaData=function(b,c,d){a.extend(this,{owner:b,key:c||"",isPrimary:!0,areaId:-1,href:"",value:d||"",options:{},selected:null,areasXref:[],area:null,optsCache:null})},b.AreaData.prototype={constuctor:b.AreaData,select:d,deselect:e,toggle:f,areas:function(){var a,b=[];for(a=0;a<this.areasXref.length;a++)b.push(this.owner.mapAreas[this.areasXref[a]]);return b},coords:function(b){var c=[];return a.each(this.areas(),function(a,d){c=c.concat(d.coords(b))}),c},reset:function(){a.each(this.areas(),function(a,b){b.reset()}),this.areasXref=[],this.options=null},isSelectedOrStatic:function(){var a=this.effectiveOptions();return c.isBool(a.staticState)?a.staticState:this.isSelected()},isSelected:function(){return c.isBool(this.selected)?this.selected:c.isBool(this.owner.area_options.selected)?this.owner.area_options.selected:!1},isSelectable:function(){return c.isBool(this.effectiveOptions().staticState)?!1:c.isBool(this.owner.options.staticState)?!1:c.boolOrDefault(this.effectiveOptions().isSelectable,!0)},isDeselectable:function(){return c.isBool(this.effectiveOptions().staticState)?!1:c.isBool(this.owner.options.staticState)?!1:c.boolOrDefault(this.effectiveOptions().isDeselectable,!0)},isNotRendered:function(){var b=a(this.area);return b.attr("nohref")||!b.attr("href")||this.effectiveOptions().isMask},effectiveOptions:function(a){var b=c.updateProps({},this.owner.area_options,this.options,a||{},{id:this.areaId
});return b.selected=this.isSelected(),b},effectiveRenderOptions:function(b,d){var e,f=this.optsCache;return f&&"highlight"!==b||(e=this.effectiveOptions(d),f=c.updateProps({},e,e["render_"+b]),"highlight"!==b&&(this.optsCache=f)),a.extend({},f)},changeState:function(b,c){a.isFunction(this.owner.options.onStateChange)&&this.owner.options.onStateChange.call(this.owner.image,{key:this.key,state:b,selected:c})},highlight:function(a){var b=this.owner;this.effectiveOptions().highlight&&b.graphics.addShapeGroup(this,"highlight",a),b.setHighlightId(this.areaId),this.changeState("highlight",!0)},drawSelection:function(){this.owner.graphics.addShapeGroup(this,"select")}},b.MapArea=function(b,d,e){if(b){var f=this;f.owner=b,f.area=d,f.areaDataXref=[],f.originalCoords=[],a.each(c.split(d.coords),function(a,b){f.originalCoords.push(parseFloat(b))}),f.length=f.originalCoords.length,f.shape=d.shape.toLowerCase(),f.nohref=d.nohref||!d.href,f.configure(e)}},b.MapArea.prototype={constructor:b.MapArea,configure:function(a){this.keys=c.split(a)},reset:function(){this.area=null},coords:function(b){return a.map(this.originalCoords,function(a){return b?a:a+b})}}}(jQuery),function(a){var b=a.mapster.utils;b.areaCorners=function(c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,x,y,z,A,B,C,v=0,w=0,D=[];for(c=c.length?c:[c],e=a(e?e:document.body),h=e.offset(),x=h.left,y=h.top,d&&(h=a(d).offset(),v=h.left,w=h.top),u=0;u<c.length;u++)if(C=c[u],"AREA"===C.nodeName){switch(z=b.split(C.coords,parseInt),C.shape){case"circle":for(r=z[0],s=z[1],A=z[2],D=[],u=0;360>u;u+=20)B=u*Math.PI/180,D.push(r+A*Math.cos(B),s+A*Math.sin(B));break;case"rect":D.push(z[0],z[1],z[2],z[1],z[2],z[3],z[0],z[3]);break;default:D=D.concat(z)}for(u=0;u<D.length;u+=2)D[u]=parseInt(D[u],10)+v,D[u+1]=parseInt(D[u+1],10)+w}else C=a(C),h=C.position(),D.push(h.left,h.top,h.left+C.width(),h.top,h.left+C.width(),h.top+C.height(),h.left,h.top+C.height());for(j=k=n=p=999999,l=m=o=q=-1,u=D.length-2;u>=0;u-=2)r=D[u],s=D[u+1],j>r&&(j=r,q=s),r>l&&(l=r,p=s),k>s&&(k=s,o=r),s>m&&(m=s,n=r);return f&&g&&(i=!1,a.each([[o-f,k-g],[n,k-g],[j-f,q-g],[j-f,p],[l,q-g],[l,p],[o-f,m],[n,m]],function(a,b){return!i&&b[0]>x&&b[1]>y?(t=b,i=!0,!1):void 0}),i||(t=[l,m])),t}}(jQuery),function(a){var b=a.mapster,c=b.utils,d=b.MapArea.prototype;b.utils.getScaleInfo=function(a,b){var c;return b?(c=a.width/b.width||a.height/b.height,c>.98&&1.02>c&&(c=1)):(c=1,b=a),{scale:1!==c,scalePct:c,realWidth:b.width,realHeight:b.height,width:a.width,height:a.height,ratio:a.width/a.height}},b.utils.scaleMap=function(a,b,d){var e=c.size(a),f=c.size(b,!0);if(!f.complete())throw"Another script, such as an extension, appears to be interfering with image loading. Please let us know about this.";return e.complete()||(e=f),this.getScaleInfo(e,d?f:null)},b.MapData.prototype.resize=function(b,d,e,f){function n(b,c,d){a.mapster.hasCanvas?(b.width=c,b.height=d):(a(b).width(c),a(b).height(d))}function o(){m.currentAction="",a.isFunction(f)&&f(),m.processCommandQueue()}function p(){if(n(m.overlay_canvas,b,d),k>=0){var a=m.data[k];a.tempOptions={fade:!1},m.getDataForKey(a.key).highlight(),a.tempOptions=null}n(m.base_canvas,b,d),m.redrawSelections(),o()}function q(){a(m.image).css(i),m.scaleInfo=c.getScaleInfo({width:b,height:d},{width:m.scaleInfo.realWidth,height:m.scaleInfo.realHeight}),a.each(m.data,function(b,c){a.each(c.areas(),function(a,b){b.resize()})})}var g,h,i,j,k,l,m=this;f=f||e,(m.scaleInfo.width!==b||m.scaleInfo.height!==d)&&(k=m.highlightId,b||(l=d/m.scaleInfo.realHeight,b=Math.round(m.scaleInfo.realWidth*l)),d||(l=b/m.scaleInfo.realWidth,d=Math.round(m.scaleInfo.realHeight*l)),i={width:String(b)+"px",height:String(d)+"px"},a.mapster.hasCanvas||a(m.base_canvas).children().remove(),j=a(m.wrapper).find(".mapster_el").add(m.wrapper),e?(h=[],m.currentAction="resizing",j.each(function(b,d){g=c.defer(),h.push(g),a(d).animate(i,{duration:e,complete:g.resolve,easing:"linear"})}),g=c.defer(),h.push(g),c.when.all(h).then(p),q(),g.resolve()):(j.css(i),q(),p()))},b.MapArea=c.subclass(b.MapArea,function(){this.base.init(),this.owner.scaleInfo.scale&&this.resize()}),d.coords=function(a,b){var c,d=[],e=a||this.owner.scaleInfo.scalePct,f=b||0;if(1===e&&0===b)return this.originalCoords;for(c=0;c<this.length;c++)d.push(Math.round(this.originalCoords[c]*e)+f);return d},d.resize=function(){this.area.coords=this.coords().join(",")},d.reset=function(){this.area.coords=this.coords(1).join(",")},b.impl.resize=function(a,c,d,e){if(!a&&!c)return!1;var f=new b.Method(this,function(){this.resize(a,c,d,e)},null,{name:"resize",args:arguments}).go();return f}}(jQuery),function(a){function d(b,c,d){var e;return c?(e="string"==typeof c?a(c):a(c).clone(),e.append(b)):e=a(b),e.css(a.extend(d||{},{display:"block",position:"absolute"})).hide(),a("body").append(e),e.attr("data-opacity",e.css("opacity")).css("opacity",0),e.show()}function e(a,b){var d={left:b.left+"px",top:b.top+"px"},e=a.attr("data-opacity")||0,f=a.css("z-index");(0===parseInt(f,10)||"auto"===f)&&(d["z-index"]=9999),a.css(d).addClass("mapster_tooltip"),b.fadeDuration&&b.fadeDuration>0?c.fader(a[0],0,e,b.fadeDuration):c.setOpacity(a[0],e)}function f(b,c,d,e,f,g){var h=d+".mapster-tooltip";return a.inArray(c,b)>=0?(e.unbind(h).bind(h,function(a){(!f||f.call(this,a))&&(e.unbind(".mapster-tooltip"),g&&g.call(this))}),{object:e,event:h}):void 0}function g(a,b,d,f,g){var h,i={};return g=g||{},b?(h=c.areaCorners(b,d,f,a.outerWidth(!0),a.outerHeight(!0)),i.left=h[0],i.top=h[1]):(i.left=g.left,i.top=g.top),i.left+=g.offsetx||0,i.top+=g.offsety||0,i.css=g.css,i.fadeDuration=g.fadeDuration,e(a,i),a}function h(a){return a?"string"==typeof a||a.jquery?a:a.content:null}var b=a.mapster,c=b.utils;a.extend(b.defaults,{toolTipContainer:'<div style="border: 2px solid black; background: #EEEEEE; width:160px; padding:4px; margin: 4px; -moz-box-shadow: 3px 3px 5px #535353; -webkit-box-shadow: 3px 3px 5px #535353; box-shadow: 3px 3px 5px #535353; -moz-border-radius: 6px 6px 6px 6px; -webkit-border-radius: 6px; border-radius: 6px 6px 6px 6px; opacity: 0.8;"></dteniv>',showToolTip:!1,toolTipFade:!0,toolTipClose:["area-mouseout","image-mouseout"],onShowToolTip:null,onHideToolTip:null}),a.extend(b.area_defaults,{toolTip:null,toolTipClose:null}),b.MapData.prototype.clearToolTip=function(){this.activeToolTip&&(this.activeToolTip.stop().remove(),this.activeToolTip=null,this.activeToolTipID=null,c.ifFunction(this.options.onHideToolTip,this))},b.AreaData.prototype.showToolTip=function(b,e){var h,i,j,k,l,m={},n=this,o=n.owner,p=n.effectiveOptions();return e=e?a.extend({},e):{},b=b||p.toolTip,i=e.closeEvents||p.toolTipClose||o.options.toolTipClose||"tooltip-click",l="undefined"!=typeof e.template?e.template:o.options.toolTipContainer,e.closeEvents="string"==typeof i?i=c.split(i):i,e.fadeDuration=e.fadeDuration||(o.options.toolTipFade?o.options.fadeDuration||p.fadeDuration:0),j=n.area?n.area:a.map(n.areas(),function(a){return a.area}),o.activeToolTipID!==n.areaId?(o.clearToolTip(),o.activeToolTip=h=d(b,l,e.css),o.activeToolTipID=n.areaId,k=function(){o.clearToolTip()},f(i,"area-click","click",a(o.map),null,k),f(i,"tooltip-click","click",h,null,k),f(i,"image-mouseout","mouseout",a(o.image),function(a){return a.relatedTarget&&"AREA"!==a.relatedTarget.nodeName&&a.relatedTarget!==n.area},k),g(h,j,o.image,e.container,l,e),c.ifFunction(o.options.onShowToolTip,n.area,{toolTip:h,options:m,areaOptions:p,key:n.key,selected:n.isSelected()}),h):void 0},b.impl.tooltip=function(c,e){return new b.Method(this,function(){var b,i,j=this;if(c){if(i=a(c),j.activeToolTipID===i[0])return;j.clearToolTip(),j.activeToolTip=b=d(h(e),e.template||j.options.toolTipContainer,e.css),j.activeToolTipID=i[0],f(["tooltip-click"],"tooltip-click","click",b,null,function(){j.clearToolTip()}),j.activeToolTip=b=g(b,i,j.image,e.container,e)}else j.clearToolTip()},function(){a.isPlainObject(c)&&!e&&(e=c),this.showToolTip(h(e),e)},{name:"tooltip",args:arguments,key:c}).go()}}(jQuery);