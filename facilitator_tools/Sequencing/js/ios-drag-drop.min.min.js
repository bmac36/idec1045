!function(t){function e(e){e=e||{},c=navigator.userAgent.match(/OS [1-4](?:_\d+)+ like Mac/)?"page":"client";var r=t.createElement("div"),i="draggable"in r,s="ondragstart"in r&&"ondrop"in r,d=!(i||s)||/iPad|iPhone|iPod|Android/.test(navigator.userAgent);g((d?"":"not ")+"patching html5 drag drop"),d&&(e.enableEnterLeave||(a.prototype.synthesizeEnterLeave=h),t.addEventListener("touchstart",n))}function a(t,e){this.dragData={},this.dragDataTypes=[],this.dragImage=null,this.dragImageTransform=null,this.dragImageWebKitTransform=null,this.el=e||t.target,g("dragstart"),this.dispatchDragStart(),this.createDragImage(),this.listen()}function n(e){var n=e.target;do if(n.draggable===!0){if(!n.hasAttribute("draggable")&&"a"==n.tagName.toLowerCase()){var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.ownerDocument.defaultView,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),n.dispatchEvent(r),g("Simulating click to anchor")}e.preventDefault(),new a(e,n)}while((n=n.parentNode)&&n!==t.body)}function r(e,a){var n=a.changedTouches[0],r=t.elementFromPoint(n[c+"X"],n[c+"Y"]);return r}function i(t,e,a,n){return n&&(a=a.bind(n)),t.addEventListener(e,a),{off:function(){return t.removeEventListener(e,a)}}}function s(t,e,a,n){function r(n){return a(n),t.removeEventListener(e,r)}return n&&(a=a.bind(n)),t.addEventListener(e,r)}function d(t,e){if(1==t.nodeType){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("style"),e.removeAttribute("draggable");for(var a=window.getComputedStyle(t),n=0;n<a.length;n++){var r=a[n];e.style.setProperty(r,a.getPropertyValue(r),a.getPropertyPriority(r))}e.style.pointerEvents="none"}if(t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++)d(t.childNodes[i],e.childNodes[i])}function g(t){console.log(t)}function o(t){return 0===t.length?0:t.reduce(function(t,e){return e+t},0)/t.length}function h(){}g=h;var c;a.prototype={listen:function(){function e(t){this.dragend(t,t.target),a.call(this)}function a(){return g("cleanup"),this.dragDataTypes=[],null!==this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImage=null,this.dragImageTransform=null,this.dragImageWebKitTransform=null),this.el=this.dragData=null,[n,r,s].forEach(function(t){return t.off()})}var n=i(t,"touchmove",this.move,this),r=i(t,"touchend",e,this),s=i(t,"touchcancel",a,this)},move:function(t){var e=[],a=[];[].forEach.call(t.changedTouches,function(t){e.push(t.pageX),a.push(t.pageY)});var n=o(e)-parseInt(this.dragImage.offsetWidth,10)/2,r=o(a)-parseInt(this.dragImage.offsetHeight,10)/2;this.translateDragImage(n,r),this.synthesizeEnterLeave(t)},translateDragImage:function(t,e){var a=" translate("+t+"px,"+e+"px)";null!==this.dragImageWebKitTransform&&(this.dragImage.style["-webkit-transform"]=this.dragImageWebKitTransform+a),null!==this.dragImageTransform&&(this.dragImage.style.transform=this.dragImageTransform+a)},synthesizeEnterLeave:function(t){var e=r(this.el,t);e!=this.lastEnter&&(this.lastEnter&&this.dispatchLeave(t),this.lastEnter=e,this.lastEnter&&this.dispatchEnter(t)),this.lastEnter&&this.dispatchOver(t)},dragend:function(e){g("dragend"),this.lastEnter&&this.dispatchLeave(e);var a=r(this.el,e);a?(g("found drop target "+a.tagName),this.dispatchDrop(a,e)):g("no drop target");var n=t.createEvent("Event");n.initEvent("dragend",!0,!0),this.el.dispatchEvent(n)},dispatchDrop:function(e,a){var n=t.createEvent("Event");n.initEvent("drop",!0,!0);var r=a.changedTouches[0],i=r[c+"X"],d=r[c+"Y"];n.offsetX=i-e.x,n.offsetY=d-e.y,n.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)},n.preventDefault=function(){}.bind(this),s(t,"drop",function(){g("drop event not canceled")},this),e.dispatchEvent(n)},dispatchEnter:function(e){var a=t.createEvent("Event");a.initEvent("dragenter",!0,!0),a.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)};var n=e.changedTouches[0];a.pageX=n.pageX,a.pageY=n.pageY,this.lastEnter.dispatchEvent(a)},dispatchOver:function(e){var a=t.createEvent("Event");a.initEvent("dragover",!0,!0),a.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)};var n=e.changedTouches[0];a.pageX=n.pageX,a.pageY=n.pageY,this.lastEnter.dispatchEvent(a)},dispatchLeave:function(e){var a=t.createEvent("Event");a.initEvent("dragleave",!0,!0),a.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)};var n=e.changedTouches[0];a.pageX=n.pageX,a.pageY=n.pageY,this.lastEnter.dispatchEvent(a),this.lastEnter=null},dispatchDragStart:function(){var e=t.createEvent("Event");e.initEvent("dragstart",!0,!0),e.dataTransfer={setData:function(t,e){return this.dragData[t]=e,-1==this.dragDataTypes.indexOf(t)&&(this.dragDataTypes[this.dragDataTypes.length]=t),e}.bind(this),dropEffect:"move"},this.el.dispatchEvent(e)},createDragImage:function(){this.dragImage=this.el.cloneNode(!0),d(this.el,this.dragImage),this.dragImage.style.opacity="0.5",this.dragImage.style.position="absolute",this.dragImage.style.left="0px",this.dragImage.style.top="0px",this.dragImage.style.zIndex="999999";var e=this.dragImage.style.transform;"undefined"!=typeof e&&(this.dragImageTransform="","none"!=e&&(this.dragImageTransform=e.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"")));var a=this.dragImage.style["-webkit-transform"];"undefined"!=typeof a&&(this.dragImageWebKitTransform="","none"!=a&&(this.dragImageWebKitTransform=a.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""))),this.translateDragImage(-9999,-9999),t.body.appendChild(this.dragImage)}},e(window.iosDragDropShim)}(document);