!function(a){var b,c=a();a.support.touch="ontouchend"in document;var d,e=!1;a.fn.sortable=function(f){var g=String(f);return f=a.extend({connectWith:!1},f),this.each(function(){if(/^enable|disable|destroy$/.test(g)){var h=a(this).children(a(this).data("items")).attr("draggable","enable"==g);return void("destroy"==g&&h.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s"))}var i,j,h=a(this).children(f.items),k=a("<"+(/^ul|ol$/i.test(this.tagName)?"li":"div")+' class="sortable-placeholder">');"horizontal"===SequencingApp.AppData.layoutStyle&&a(k).addClass("horizontal"),h.find(f.handle).mousedown(function(){i=!0}).mouseup(function(){i=!1}),a(this).data("items",f.items),c=c.add(k),f.connectWith&&a(f.connectWith).add(this).data("connectWith",f.connectWith),a.fn.hitTest=function(b,c){var d=a(this).offset();return d.right=d.left+this.innerWidth(),d.bottom=d.top+this.innerHeight(),b>=d.left&&b<=d.right&&c>=d.top&&c<=d.bottom?!0:!1};var m;h.attr("draggable","true").on("touchstart",function(c){if(SequencingApp.prevIndex=a(this).index(),c.preventDefault(),!(void 0===c.originalEvent.touches||c.originalEvent.touches.length>1)){for(var d=0;d<a("#sortList").children("li").length;d++)a("#sortItem"+d).attr("aria-hidden",!0);var e=c.originalEvent;b=this,a(this).data("index",a(this).addClass("sortable-dragging").index()),a(this).children(".feedbackBar").css("display","none"),a(".sortable-placeholder").remove(),"horizontal"===SequencingApp.AppData.layoutStyle?(a(".sortable-placeholder").addClass("horizontal"),a(this).addClass("horizontal")):(a(".sortable-placeholder").addClass("vertical"),a(this).addClass("vertical"),a(this).width(a("#placeholderContent li").width()));var f=a("#"+a(this).attr("id"));a('<li class="sortable-placeholder"></li>').insertBefore(f),"horizontal"===SequencingApp.AppData.layoutStyle&&a(".sortable-placeholder").css("float","left"),a(".sortable-placeholder").css("margin-left",a(b).css("margin-left")),a(".sortable-placeholder").css("margin-right",a(b).css("margin-right")),a(".sortable-placeholder").css("margin-top",a(b).css("margin-top")),a(".sortable-placeholder").css("margin-bottom",a(b).css("margin-bottom")),"horizontal"===SequencingApp.AppData.layoutStyle?(a(".sortable-placeholder").addClass("horizontal"),a(".sortable-placeholder").css("margin-top",a(b).css("margin-top")),a(".sortable-placeholder").height(a(b).height()),a(".sortable-placeholder").width(a(b).outerWidth()),a(".sortable-placeholder").css("margin-bottom","5px !important")):(a(".sortable-placeholder").height(a(b).height()),a(".sortable-placeholder").width(a("#placeholderContent li").outerWidth()),a(".sortable-placeholder").css("padding-left","0px"),a(".sortable-placeholder").css("padding-right","0px")),locY=e.changedTouches[0].pageY-a(b).height()/2+"px",locX=e.changedTouches[0].pageX-a(b).width()/2*2+"px",a("body").append(a(this)),a(this).css("z-index","99999"),"vertical"===SequencingApp.AppData.layoutStyle?(a(b).css({position:"absolute",top:locY,left:a("#sortList").position().left}),mouse_X=locX):(a(this).css({position:"absolute",top:e.changedTouches[0].pageY-a(b).height()/2+"px",left:e.changedTouches[0].pageX-a(b).width()/2+"px"}),mouse_X=locX,m=locY)}});var n,o;SequencingApp.prevIndex,h.attr("draggable","true").on("touchmove",function(c){c.preventDefault();var f,j,d=c.originalEvent,e=!1,g=a(window).scrollLeft(),h=a(window).scrollTop();"vertical"===SequencingApp.AppData.layoutStyle?a(this).css({position:"absolute",top:d.changedTouches[0].pageY-a(b).height()/2+"px"}):a(this).css({position:"absolute",top:d.changedTouches[0].pageY-a(b).height()/2+"px",left:d.changedTouches[0].pageX-a(b).width()/2+"px"});for(var g=a(window).scrollLeft(),h=a(window).scrollTop(),k=0;k<a("#sortList").children("li").length;k++)if(e=a("#sortItem"+k).hitTest(d.changedTouches[0].clientX+g,d.changedTouches[0].clientY+h),1==e&&a("#sortItem"+k).attr("id")!=a(b).attr("id")){f=a("#sortItem"+k),j=f.index();break}var m,p,l=c.originalEvent.touches?c.originalEvent.touches[0].pageY:c.pageY;if(m=l>o?"down":"up",o=l,f){if("vertical"===SequencingApp.AppData.layoutStyle)return a(".sortable-placeholder").remove(),"down"==m?(a(".sortable-placeholder").remove(),a('<li class="sortable-placeholder"></li>').insertAfter(f)):a('<li class="sortable-placeholder"></li>').insertBefore(f),a(".sortable-placeholder").css("margin-top",a(b).css("margin-top")),a(".sortable-placeholder").css("margin-bottom",a(b).css("margin-bottom")),a(".sortable-placeholder").css("padding-left","0px"),a(".sortable-placeholder").css("padding-right","0px"),a(".sortable-placeholder").height(a(b).innerHeight()),"horizontal"===SequencingApp.AppData.layoutStyle?a(".sortable-placeholder").addClass("horizontal"):a(".sortable-placeholder").addClass("vertical"),a(".sortable-placeholder").height(a(b).height()),void a(".sortable-placeholder").width(a(b).outerWidth());if("horizontal"===SequencingApp.AppData.layoutStyle){a(".sortable-placeholder").remove();var q=c.originalEvent.touches?c.originalEvent.touches[0].pageX:c.pageX;p=q>n?"right":"left",n=q,f&&("right"==p?a('<li class="sortable-placeholder"></li>').insertAfter(f):j===a(".sortItem").length-1?a('<li class="sortable-placeholder"></li>').insertAfter(f):a('<li class="sortable-placeholder"></li>').insertBefore(f),a(".sortable-placeholder").height(a(b).height()),a(".sortable-placeholder").width(a(b).outerWidth()),"horizontal"===SequencingApp.AppData.layoutStyle?a(".sortable-placeholder").addClass("horizontal"):a(".sortable-placeholder").addClass("vertical"),a(".sortable-placeholder").addClass("horizontal"),a(".sortable-placeholder").css("margin-top",a(b).css("margin-top")),a(".sortable-placeholder").height(a(b).innerHeight()),a(".sortable-placeholder").css("margin-bottom","5px !important"))}}}),h.attr("draggable","true").on("touchend",function(c){d&&d.stop(),a(this).children(".feedbackBar").css("display","block"),a(this).width("");a("#sortList li").get(a(this).data("index"));a(this).data("index")===a("#sortList").children().length?(a("#sortList").append(this),a(this).css({position:""})):(a(this).insertBefore(".sortable-placeholder"),a(".sortable-placeholder").remove(),a(this).css({position:""})),a(this).removeClass("sortable-dragging"),setTimeout(function(){a(".sortable-placeholder").remove(),a("li").removeClass("sortable-dragging"),"continuous"!==SequencingApp.AppData.FeedbackType&&a("#sortList li").each(function(b,c){a(c).attr("aria-label",a("#placeholder"+a(c).index()+" div").children("div").text()+" "+a(c).children().text()),a(c).attr("aria-posinset",a(c).index()+1),a(c).children().attr("aria-label",a(c).attr("aria-label"))})},0);for(var f=0;f<a("#sortList").children("li").length;f++)a("#sortItem"+f).attr("aria-hidden",!1);a(this).append('<div id="ariaAlert" role="alert" aria-live="assertive" style="left:9999;position:absolute"> You moved the tile from '+SequencingApp.AppData.sortItems[SequencingApp.prevIndex].placeHolderText+" to "+SequencingApp.AppData.sortItems[a(this).index()].placeHolderText+"</div>"),a(this).focus(),("continuous"===SequencingApp.AppData.FeedbackType||1==SequencingApp.isRetry)&&SequencingApp.checkContinuousAnswers(),setTimeout(function(c){a(b).focus(),b=null,a("#ariaAlert").remove()},1e3)}),h.attr("draggable","true").on("dragstart.h5s ",function(c){if(SequencingApp.prevIndex=a(this).index(),f.handle&&!i)return!1;d2log(a(this)),i=!1;var d=c.originalEvent.dataTransfer;d.effectAllowed="move",d.setData("Text","");for(var e=0;e<a("#sortList").children("li").length;e++)a("#sortItem"+e).attr("aria-hidden",!0);a(this).width(a("#placeholderContent li").width()),j=(b=a(this)).addClass("sortable-dragging").index(),a(".sortItem.vertical").css("display","block"),a(this).children(".feedbackBar").css("display","none")}).on("dragend",function(f){f.preventDefault(),d&&d.stop(),e=!0,d2log(b),b.removeClass("sortable-dragging").show(),c.detach(),a(this).width(""),j!==b.index()&&h.parent().trigger("sortupdate",{item:b}),setTimeout(function(){a(b).css("display","block")},0),a(this).children(".feedbackBar").css("display","block"),a(".sortItem").each(function(b,c){a(c).attr("aria-label",a("#placeholder"+b).text()+" "+a(a(c).children()[0]).text())});for(var g=0;g<a("#sortList").children("li").length;g++)a("#sortItem"+g).attr("aria-hidden",!1);a(this).append('<div id="ariaAlert" role="alert" aria-atomic="true" aria-live="assertive" style="left:0;position:absolute"> You moved the tile from '+SequencingApp.AppData.sortItems[SequencingApp.prevIndex].placeHolderText+" to "+SequencingApp.AppData.sortItems[a(this).index()].placeHolderText+"</div>"),setTimeout(function(b){a("#ariaAlert").remove()},500),setTimeout(function(c){a(b).focus()},5e3),("continuous"===SequencingApp.AppData.FeedbackType||1==SequencingApp.isRetry)&&SequencingApp.checkContinuousAnswers(),b=null,a("#sortList li.vertical img").each(function(b,c){a(c).css("margin-top",a(".sortItem").height()/2-a(c).height()/2),a(c).css("margin-bottom",a(".placeholderTitle").outerHeight()+"px")})}).not("a[href]").on("selectstart.h5s",function(){return"ie"===document.body.getAttribute("browser")&&"9.0"===document.body.getAttribute("browserversion")?(this.dragDrop&&this.dragDrop(),!1):void 0}).end().add([this,k]).on("dragover.h5s dragenter.h5s drop.h5s",function(e){return h.is(b)||f.connectWith===a(b).parent().data("connectWith")?("firefox"==a("body").attr("browser")&&("vertical"===SequencingApp.AppData.layoutStyle?a(".sortable-placeholder").offset()&&(void 0!==a(parent.document).find(".d2l-iframe")[0]&&a(".sortable-placeholder").offset().top+(a(parent.document).find(".d2l-iframe")[0].offsetTop-a(window.top).scrollTop())>a(window.top).height()-250?d=a(window.top.document.documentElement).stop(!0).animate({scrollTop:a(window.top).scrollTop()+5},0):void 0!==a(parent.document).find(".d2l-iframe")[0]&&a(".sortable-placeholder").offset().top+(a(parent.document).find(".d2l-iframe")[0].offsetTop-a(window.top).scrollTop())<150?d=a(window.top.document.documentElement).stop(!0).animate({scrollTop:a(window.top).scrollTop()-5},0):d&&d.stop()):a(".sortable-placeholder").offset()&&(void 0!==a(parent.document).find(".d2l-iframe")[0]&&e.originalEvent.offsetY+a(".sortable-placeholder").height()+(a(parent.document).find(".d2l-iframe")[0].offsetTop-a(window.top).scrollTop())>a(window.top).height()-150?d=a(window.top.document.documentElement).stop(!0).animate({scrollTop:a(window.top).scrollTop()+5},0):void 0!==a(parent.document).find(".d2l-iframe")[0]&&e.originalEvent.pageY+(a(parent.document).find(".d2l-iframe")[0].offsetTop-a(window.top).scrollTop())<50?d=a(window.top.document.documentElement).stop(!0).animate({scrollTop:a(window.top).scrollTop()-5},0):d&&d.stop())),a(".sortable-placeholder").length>0&&"ie"==a("body").attr("browser")&&(e.originalEvent.clientY-a(window.top).scrollTop()>=a(window.top).height()-100?d=a(window.top.document.documentElement).stop(!0).animate({scrollTop:a(window.top).scrollTop()+1},0):e.originalEvent.clientY<=100?d=a(window.top.document.documentElement).stop(!0).animate({scrollTop:a(window.top).scrollTop()-1},0):d&&d.stop()),"drop"==e.type?(e.preventDefault(),e.stopPropagation(),c.filter(":visible").after(b),!1):(e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",h.is(this)?(f.forcePlaceholderSize&&("horizontal"===SequencingApp.AppData.layoutStyle?a(".sortable-placeholder").addClass("horizontal"):a(".sortable-placeholder").addClass("vertical")),b.hide(),a(b).css("display","none"),setTimeout(function(){a(".sortItem").not(b).css("display","")},0),a(this)[k.index()<a(this).index()?"after":"before"](k),c.not(k).detach(),"horizontal"===SequencingApp.AppData.layoutStyle?(a(".sortable-placeholder").addClass("horizontal"),a(".sortable-placeholder").css("margin-top",a(b).css("margin-top")),a(".sortable-placeholder").height(a(b).height()),a(".sortable-placeholder").css("margin-bottom",a(b).css("margin-bottom"))):(a(".sortable-placeholder").height(a(b).innerHeight()),a(".sortable-placeholder").width(a(b).width()),a(".sortable-placeholder").css("margin-top",a(b).css("margin-top")),a(".sortable-placeholder").css("margin-bottom",0),a(".sortable-placeholder").css("padding-left","0px"),a(".sortable-placeholder").css("padding-right","0px"))):c.is(this)||a(this).children(f.items).length||(c.detach(),a(this).append(k)),!1)):!0})})}}(jQuery);